<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Annâ€™s Ventures â€” Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body{margin:0;font-family:'Poppins',sans-serif;background:#fff;color:#2a2a2a}
    header{background:#ff5f9a;color:#fff;text-align:center;padding:12px;font-weight:600}
    .contact{background:#fff;border-bottom:1px solid #f4c2d8;color:#7a2a56;text-align:center;padding:8px;font-size:14px}
    .wrap{max-width:1000px;margin:0 auto;padding:20px}
    .title{font-family:'Playfair Display',serif;color:#7a2a56;margin:0 0 20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px}
    .product{border:1px solid #f4c2d8;border-radius:14px;padding:12px;background:#fff;box-shadow:0 4px 12px rgba(255,95,154,.1)}
    .product img{width:100%;height:180px;object-fit:cover;border-radius:12px}
    .pill{background:#ffe4ef;border:1px solid #f3a6c6;border-radius:999px;padding:4px 10px;font-size:12px;color:#8b3b64;display:inline-block;margin-top:6px}
    .price{font-weight:700;color:#ff5f9a;margin-top:6px}
    .desc{margin-top:6px;font-size:13px;color:#444}
    .btn{margin-top:10px;padding:8px 12px;border:none;border-radius:10px;background:#ff5f9a;color:#fff;font-weight:600;cursor:pointer}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);align-items:center;justify-content:center}
    .modal-content{background:#fff;padding:20px;border-radius:14px;max-width:400px;width:100%}
    .modal-content h2{margin-top:0;color:#7a2a56}
    .modal-content input,.modal-content textarea{width:100%;padding:8px;margin-bottom:10px;border:1px solid #f1c1d7;border-radius:8px}
  </style>
</head>
<body>
  <!-- Banner -->
  <header>ðŸšš Nationwide Delivery Available</header>
  <!-- Contact strip -->
  <div class="contact">
    Email: <a href="mailto:hannahadaja63@gmail.com">hannahadaja63@gmail.com</a> | Phone: <a href="tel:+2349046588565">+234 904 658 8565</a>
  </div>

  <div class="wrap">
    <h1 class="title">Annâ€™s Ventures â€” Shop</h1>
    <div id="products" class="grid"></div>
  </div>

  <!-- Checkout Modal -->
  <div id="checkoutModal" class="modal">
    <div class="modal-content">
      <h2>Checkout</h2>
      <div id="cart-items"></div>
      <div id="cart-total" style="font-weight:700;color:#ff5f9a;margin:10px 0">Total: â‚¦0</div>
      <input id="custName" type="text" placeholder="Full Name">
      <input id="custEmail" type="email" placeholder="Email">
      <input id="custPhone" type="text" placeholder="Phone">
      <textarea id="custAddress" placeholder="Delivery Address"></textarea>
      <button id="placeOrderBtn" class="btn">Place Order</button>
      <button id="closeModalBtn" class="btn ghost" style="margin-top:8px">Cancel</button>
    </div>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDeuEMpCf90Y8P5M0Xahwi_zMeHZeqod-Q",
    authDomain: "annsventure-51957.firebaseapp.com",
    projectId: "annsventure-51957",
    storageBucket: "annsventure-51957.appspot.com",
    messagingSenderId: "1054919145056",
    appId: "1:1054919145056:web:64c35fc1507000984b3505",
    measurementId: "G-SSN8TYCRWQ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const productList = document.getElementById('products');
  const checkoutModal = document.getElementById('checkoutModal');
  const cartItemsEl = document.getElementById('cart-items');
  const cartTotalEl = document.getElementById('cart-total');
  const placeOrderBtn = document.getElementById('placeOrderBtn');
  const closeModalBtn = document.getElementById('closeModalBtn');

  let cart=[];

  function updateCart(){
    cartItemsEl.innerHTML='';
    let total=0;
    cart.forEach((item,i)=>{
      total+=parseFloat(item.price);
      const div=document.createElement('div');
      div.textContent=`${item.title} â€” â‚¦${item.price}`;
      cartItemsEl.appendChild(div);
    });
    cartTotalEl.textContent='Total: â‚¦'+total;
  }

  const q=query(collection(db,"products"), orderBy("createdAt","desc"));
  onSnapshot(q,(snapshot)=>{
    productList.innerHTML='';
    snapshot.forEach(docSnap=>{
      const p=docSnap.data();
      const div=document.createElement('div');
      div.className='product';
      div.innerHTML=`
        <img src="${p.image||''}" alt="${p.title||''}">
        <h3>${p.title||''}</h3>
        <span class="pill">${p.category||''}</span>
        <div class="price">â‚¦${p.price||0}</div>
        <div class="desc">${p.description||''}</div>
        <button class="btn">Add to Cart</button>
      `;
      div.querySelector('button').addEventListener('click',()=>{
        cart.push(p);
        updateCart();
        checkoutModal.style.display='flex';
      });
      productList.appendChild(div);
    });
  });

  placeOrderBtn.addEventListener('click', async ()=>{
    if(cart.length===0){alert("Cart is empty");return;}
    const name=document.getElementById('custName').value.trim();
    const email=document.getElementById('custEmail').value.trim();
    const phone=document.getElementById('custPhone').value.trim();
    const address=document.getElementById('custAddress').value.trim();
    if(!name||!email||!phone||!address){alert("Fill all fields");return;}

    const total=cart.reduce((sum,i)=>sum+parseFloat(i.price),0);

    await addDoc(collection(db,"orders"),{
      customer:{name,email,phone,address},
      items:cart,
      total,
      createdAt:serverTimestamp()
    });

    window.location.href = "thankyou.html";
  });

  closeModalBtn.addEventListener('click',()=>{
    checkoutModal.style.display='none';
  });
</script>
</body>
</html>
