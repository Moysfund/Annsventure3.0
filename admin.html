<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ann’s Ventures — Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{--pink:#ff5f9a; --rose:#7a2a56; --border:#f4c2d8;}
    body{margin:0;font-family:'Poppins',sans-serif;color:#2a2a2a}
    header{background:var(--pink);color:#fff;text-align:center;padding:12px;font-weight:600}
    .wrap{max-width:1000px;margin:0 auto;padding:16px}
    h1{font-family:'Playfair Display',serif;color:var(--rose);margin:10px 0 16px}
    form{display:grid;grid-template-columns:1fr 1fr;gap:12px;border:1px solid var(--border);padding:12px;border-radius:12px}
    form input, form select, form textarea{padding:10px;border:1px solid var(--border);border-radius:8px}
    form button{padding:10px;border:none;border-radius:10px;background:var(--pink);color:#fff;font-weight:600;cursor:pointer}
    .list{margin-top:16px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .item{border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff}
    .item img{width:100%;height:150px;object-fit:cover;border-radius:10px}
    .item h3{margin:8px 0 4px;color:var(--rose);font-size:16px}
    .item .meta{font-size:13px;color:#666}
    .item .price{font-weight:700;color:var(--pink);margin-top:6px}
    .actions{margin-top:8px;display:flex;gap:8px}
    .actions button{flex:1;padding:6px;border:none;border-radius:8px;cursor:pointer;font-weight:600}
    .edit{background:#ffe4ef;color:#7a2a56}
    .delete{background:#a33;color:#fff}
    .row{grid-column:1/-1}
    footer{margin-top:30px;padding:20px;text-align:center;color:#666;font-size:13px;border-top:1px solid var(--border)}
    footer a{color:var(--rose);text-decoration:none;font-weight:600}
  </style>
</head>
<body>
  <header>Ann’s Ventures — Admin</header>
  <div class="wrap">
    <h1>Manage products</h1>

    <form id="productForm">
      <input id="title" type="text" placeholder="Title" required>
      <input id="price" type="number" placeholder="Price (₦)" step="0.01" required>
      <select id="category" required>
        <option value="">Select category</option>
        <option value="Wear">Wear</option>
        <option value="Drink">Drink</option>
      </select>
      <input id="image" type="url" placeholder="Image URL (https://)" required>
      <textarea id="description" class="row" placeholder="Description" rows="3" required></textarea>
      <button type="submit" class="row">Save product</button>
    </form>

    <div class="list" id="productList"></div>
  </div>

  <footer>
    <a href="index.html">Storefront</a> • <a href="orders.html">Orders</a> • Contact: <a href="mailto:hannahadaja63@gmail.com">hannahadaja63@gmail.com</a>
  </footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDeuEMpCf90Y8P5M0Xahwi_zMeHZeqod-Q",
    authDomain: "annsventure-51957.firebaseapp.com",
    projectId: "annsventure-51957",
    storageBucket: "annsventure-51957.appspot.com",
    messagingSenderId: "1054919145056",
    appId: "1:1054919145056:web:64c35fc1507000984b3505",
    measurementId: "G-SSN8TYCRWQ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const form = document.getElementById('productForm');
  const productList = document.getElementById('productList');

  let editId = null; // track if editing

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const title = document.getElementById('title').value.trim();
    const price = parseFloat(document.getElementById('price').value.trim());
    const category = document.getElementById('category').value;
    const image = document.getElementById('image').value.trim();
    const description = document.getElementById('description').value.trim();

    if(!title || !price || !category || !image || !description){
      alert("Fill all fields");
      return;
    }

    if(editId){
      // update existing
      const ref = doc(db,"products",editId);
      await updateDoc(ref,{title,price,category,image,description});
      alert("Product updated");
      editId=null;
    } else {
      // add new
      await addDoc(collection(db, "products"), {
        title, price, category, image, description,
        createdAt: serverTimestamp()
      });
      alert("Product added");
    }

    form.reset();
  });

  const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
  onSnapshot(q, (snapshot)=>{
    productList.innerHTML='';
    snapshot.forEach(docSnap=>{
      const p=docSnap.data();
      const id=docSnap.id;
      const card=document.createElement('div');
      card.className='item';
      card.innerHTML=`
        <img src="${p.image||''}" alt="${p.title||''}">
        <h3>${p.title||''}</h3>
        <div class="meta">${p.category||''}</div>
        <div class="price">₦${p.price||0}</div>
        <div class="meta">${p.description||''}</div>
        <div class="actions">
          <button class="edit">Edit</button>
          <button class="delete">Delete</button>
        </div>
      `;
      // Edit
      card.querySelector('.edit').addEventListener('click', ()=>{
        document.getElementById('title').value=p.title;
        document.getElementById('price').value=p.price;
        document.getElementById('category').value=p.category;
        document.getElementById('image').value=p.image;
        document.getElementById('description').value=p.description;
        editId=id;
        window.scrollTo({top:0,behavior:'smooth'});
      });
      // Delete
      card.querySelector('.delete').addEventListener('click', async ()=>{
        if(confirm("Delete this product?")){
          await deleteDoc(doc(db,"products",id));
        }
      });
      productList.appendChild(card);
    });
  });
</script>
</body>
</html>
